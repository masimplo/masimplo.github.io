
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Testing Ionic presentables</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css?v=419cf50777">

    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="masimplo's blog">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Testing Ionic presentables">
    <meta property="og:description" content="I frequently come across the question of how we can test a presentable in Ionic. A presentable is component that is presented in a separate navigation stack like a Modal, an Alert, an ActionSheet, a Toast, a LoadingModal etc. Our code will normally look like: private openEditorModal() {   const modal = this.">
    <meta property="og:url" content="https://masimplo.com/testing-ionic-presentables/">
    <meta property="article:published_time" content="2017-06-30T09:48:50.000Z">
    <meta property="article:modified_time" content="2017-06-30T09:48:50.000Z">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Testing Ionic presentables">
    <meta name="twitter:description" content="I frequently come across the question of how we can test a presentable in Ionic. A presentable is component that is presented in a separate navigation stack like a Modal, an Alert, an ActionSheet, a Toast, a LoadingModal etc. Our code will normally look like: private openEditorModal() {   const modal = this.">
    <meta name="twitter:url" content="https://masimplo.com/testing-ionic-presentables/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Michael Asimakopoulos">
    <meta name="twitter:site" content="@masimplo">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "masimplo&#x27;s blog",
        "logo": {
            "@type": "ImageObject",
            "url": "https://masimplo.com/content/images/2016/09/duck-1.png",
            "width": 50,
            "height": 52
        }
    },
    "author": {
        "@type": "Person",
        "name": "Michael Asimakopoulos",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/b8fac58b927d2d263defca6e9e31c2e2?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://masimplo.com/author/michael/",
        "sameAs": []
    },
    "headline": "Testing Ionic presentables",
    "url": "https://masimplo.com/testing-ionic-presentables/",
    "datePublished": "2017-06-30T09:48:50.000Z",
    "dateModified": "2017-06-30T09:48:50.000Z",
    "description": "I frequently come across the question of how we can test a presentable in Ionic. A presentable is component that is presented in a separate navigation stack like a Modal, an Alert, an ActionSheet, a Toast, a LoadingModal etc. Our code will normally look like: private openEditorModal() {   const modal &#x3D; this.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://masimplo.com/"
    }
}
    </script>

    <script type="text/javascript" src="../public/ghost-sdk.js?v=419cf50777"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "831f46eb998d"
});
</script>
    <meta name="generator" content="Ghost 1.14">
    <link rel="alternate" type="application/rss+xml" title="masimplo's blog" href="../rss/index.html">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/tomorrow-night-eighties.min.css">
<style>  
  pre {
    word-wrap: normal;
    -moz-hyphens: none;
    -ms-hyphens: none;
    -webkit-hyphens: none;
    hyphens: none;
    font-size: 0.8em;
    line-height: 1.3em;
  }
    pre code, pre tt {
    white-space: pre;
  }
</style>

</head>
<body class="post-template">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="../"><img src="../content/images/2016/09/duck-1.png" alt="masimplo's blog"></a>
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="http://masimplo.com">Home</a></li>
</ul>

    </div>
    <div class="site-nav-right">
        <div class="social-links">
                <a class="social-link social-link-tw" href="https://twitter.com/masimplo" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
</a>
        </div>
            <a class="subscribe-button" href="index.html#subscribe">Subscribe</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post no-image">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2017-06-30">30 June 2017</time>
                </section>
                <h1 class="post-full-title">Testing Ionic presentables</h1>
            </header>


            <section class="post-full-content">
                <div class="kg-card-markdown"><p>I frequently come across the question of how we can test a presentable in Ionic. A presentable is component that is presented in a separate navigation stack like a Modal, an Alert, an ActionSheet, a Toast, a LoadingModal etc.</p>
<p>Our code will normally look like:</p>
<pre><code>private openEditorModal() {
  const modal = this._modal.create(MyModalComponent);
  modal.onDidDismiss((data: { note: string }) =&gt; {
    this.note = data.note;
  });
  modal.present();
}
</code></pre>
<p>So how can we test that this.note will take the value returned from the modal? We need a way to trigger onDidDismiss.<br>
After gathering a few similar cases that I wanted to test I came up with a mock that can be used to test such functionality, mimicking the behaviour of normal presentables.</p>
<pre><code>export class PresentableControllerMock {
  public presentableRef = {
    present: () =&gt; Promise.resolve(),
    dismiss: (data?: any) =&gt; {
      if (this.dismissCallbackFn) {
        this.dismissCallbackFn(data);
      }
      return Promise.resolve({});
    },
    onDidDismiss: (fn) =&gt; {
      this.dismissCallbackFn = fn;
    }
  };

  public dismissCallbackFn = null;

  public create(options?) {
    return Object.assign(this.presentableRef, options);
  }
}
</code></pre>
<p>Now this opens up a few possibilities in our tests. Let's have a look at a simple case first.</p>
<pre><code>  it('updates the note if it is edited', function () {
    const modalCtrl = fixture.debugElement.injector.get(ModalController);
    spyOn(modalCtrl, 'create').and.callThrough();
    const modal = (&lt;PresentableControllerMock&gt;(&lt;any&gt;modalCtrl)).presentableRef;
    spyOn(modal, 'present').and.callThrough();

    sut.openEditorModal();

    expect(modal.present).toHaveBeenCalled();
    modal.dismiss({ note: 'new note' });
      
    expect(sut.notes).toEqual('new note');
  });
</code></pre>
</div>
            </section>

            <section class="subscribe-form">
                <h3 class="subscribe-form-title">Subscribe to masimplo's blog</h3>
                <p>Get the latest posts delivered right to your inbox</p>
                <form method="post" action="https://masimplo.com/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"><input class="location" type="hidden" name="location"><input class="referrer" type="hidden" name="referrer">

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email" placeholder="youremail@example.com">
    </div>
    <button class="" type="submit"><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>


            </section>

            <div id="disqus_thread"></div>
            <script>

            /**
            *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
            *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
            var disqus_config = function () {
            this.page.url = "https://masimplo.com/testing-ionic-presentables/";  // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = "ghost-31"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };
            (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://bits-bytes-2.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
            })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


            <footer class="post-full-footer">

                <section class="author-card">
                        <img class="author-profile-image" src="http://www.gravatar.com/avatar/b8fac58b927d2d263defca6e9e31c2e2?s=250&amp;d=mm&amp;r=x" alt="Michael Asimakopoulos">
                    <section class="author-card-content">
                        <h4 class="author-card-name"><a href="../author/michael/">Michael Asimakopoulos</a></h4>
                            <p>Read <a href="../author/michael/">more posts</a> by this author.</p>
                    </section>
                </section>
                <div class="post-full-footer-right">
                    <a class="author-card-button" href="../author/michael/">Read More</a>
                </div>

            </footer>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">

                <article class="post-card post">
        <a class="post-card-image-link" href="../using-environment-config-in-ionic2/">
            <div class="post-card-image" style="background-image: url(../content/images/2017/09/rsz_elizabeth-lies-20237.jpg)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../using-environment-config-in-ionic2/">
            <header class="post-card-header">
                <h2 class="post-card-title">Using environment config in Ionic2</h2>
            </header>
            <section class="post-card-excerpt">
                <p>After you finish building your app and you are ready to deploy to the App Stores you will realize that you need to use specific variables for the production environment that are different</p>
            </section>
        </a>
        <footer class="post-card-meta">
                <img class="author-profile-image" src="http://www.gravatar.com/avatar/b8fac58b927d2d263defca6e9e31c2e2?s=250&amp;d=mm&amp;r=x" alt="Michael Asimakopoulos">
            <span class="post-card-author"><a href="../author/michael/">Michael Asimakopoulos</a></span>
        </footer>
    </div>
</article>

                <article class="post-card post">
        <a class="post-card-image-link" href="../adding-type-safety-to-immutable-js-with-typescript-string-literals-and-keyof/">
            <div class="post-card-image" style="background-image: url(../content/images/2017/05/ts.svg)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../adding-type-safety-to-immutable-js-with-typescript-string-literals-and-keyof/">
            <header class="post-card-header">
                <h2 class="post-card-title">Adding type safety to Immutable.js with Typescript string literals and keyof</h2>
            </header>
            <section class="post-card-excerpt">
                <p>Using immutable data structures is all the rage and for a good reason. After having used immutables in some large projects I can personally testify that after getting used to the initial adaptation</p>
            </section>
        </a>
        <footer class="post-card-meta">
                <img class="author-profile-image" src="http://www.gravatar.com/avatar/b8fac58b927d2d263defca6e9e31c2e2?s=250&amp;d=mm&amp;r=x" alt="Michael Asimakopoulos">
            <span class="post-card-author"><a href="../author/michael/">Michael Asimakopoulos</a></span>
        </footer>
    </div>
</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="../">
            <span>masimplo's blog</span>
        </a>
    </div>
    <span class="floating-header-divider">—</span>
    <div class="floating-header-title">Testing Ionic presentables</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"></path>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Testing%20Ionic%20presentables&amp;url=https://masimplo.com/testing-ionic-presentables/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://masimplo.com/testing-ionic-presentables/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"></path></svg>
        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../">masimplo's blog</a> © 2017</section>
                <nav class="site-footer-nav">
                    <a href="../">Latest Posts</a>
                    
                    <a href="https://twitter.com/masimplo" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="index.html#"></a>
        <div class="subscribe-overlay-content">
                <img class="subscribe-overlay-logo" src="../content/images/2016/09/duck-1.png" alt="masimplo's blog">
            <h1 class="subscribe-overlay-title">Subscribe to masimplo's blog</h1>
            <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
            <form method="post" action="https://masimplo.com/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"><input class="location" type="hidden" name="location"><input class="referrer" type="hidden" name="referrer">

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email" placeholder="youremail@example.com">
    </div>
    <button class="" type="submit"><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>


        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=419cf50777"></script>


    <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>


    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-28844594-2', 'auto');
  ga('send', 'pageview');
</script>

</body>
